# Overview
Simulation studies were performed under two cases. Each case simulated 3 potential global dietary patterns for $S=4$ subpopulations. 
Membership of a subject's respective global dietary pattern $(C_i for i \in 1,\ldots, n)$ was incorporated into a probit regression model with subpopulation membership as a potential demographic confounder, under a cell means coding scheme, such that 

$$Pr(y_i=1|\xi, C_i, s_i) =\Phi(\sum_{h=1}^3 1(C_i = h)\xi_h + \sum_{w=1}^S 1(s_i=w) \xi_{3+w}).$$  

A total of 4800 subjects were simulated with 1200 subjects assigned to each of the 4 subpopulations. 
Membership into each global profile was randomized across the full 4800 simulated population with equal probability into global profile 1, 2 or 3. 
Once pre-assigned, observed patterns for each subject were determined by randomly drawing from a Multinomial distribution, where the expected true response level had a selection probability of 0.85 and all other response levels had a selection probability of 0.05. 
Observed outcome values were generated by drawing from a Bernoulli distribution using the probit regression model, where $\xi = (1, 1.1, 1.2, 0.9, 1,-2,-1)$. 

Case B simulates a scenario where global dietary patterns associated with an outcome were present and subpopulations had local patterns that deviated from the global dietary patterns for a subset of foods. 

# Run Code
* Input data source: sim_SRPCdataB52.mat

* sim_sRPCB52.m - The fixed and adaptive sampling of the supervised RPC is implemented and condensed into a single code. 
  * Output files - py_simResults_B52.mat
    * py_pred - Nx1 predicted probability vector of response outcome
    * pred_ci - Nx1 predicted global assignment for each subject calculated from posterior median model parameter estimates
    * pred_nu - Sxp matrix of posterior probability of a given variable being allocated to the global or local level for each subpopulation
    * DIC - Deviance information criterion as specified in Celeux, 2006
    * DIC_star - deviance information version 6 to penalize for data complexity as specified in Celeux, 2006
    * t_I0 - Sxp matrix of posterior mode for each exposure variable derived for each cluster
    * y_mse - mean squared error comparing true and predicted response outcome 
    * nu_mse - mean squared error comparing true and predicted probability matrix of (global/local) variable allocation 
    * G52_derivations.png - plot figure of median posterior probability matrix of predicted and true $\nu$
    * theta0sRPC_simB52.fig - matlab figure illustrating posterior modal pattern derived for each cluster (t_I0)
    * theta0_simB52.fig - matlab figure illustrating true modal cluster pattern
* sim_LCAprobitB52.m - The Gibbs sampler of the supervised LCA is implemented here. 
  * Output files - simLCAprobitResults_B52.mat
    * theta0_med - Nx1 predicted probability vector of response outcome
    * pi_med - Kx1 posterior median probability of cluster assignment
    * pred_ci - Nx1 predicted global assignment for each subject calculated from posterior median model parameter estimates
    * xi_ci - credible interval of regression coefficients
    * dic_reg - Deviance information criterion as specified in Celeux, 2006
    * dic_star - deviance information version 6 to penalize for data complexity as specified in Celeux, 2006
    * t_I0 - Sxp matrix of posterior mode for each exposure variable derived for each cluster
    * y_mse - mean squared error comparing true and predicted response outcome 
    * theta0slca_simB52.fig - matlab figure illustration posterior modal pattern derived for each cluster (t_I0)
    
